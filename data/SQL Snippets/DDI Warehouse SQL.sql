/****** Object:  Table [dbo].[AGING DEFINITION]    Script Date: 5/31/2019 2:30:57 PM ******/
CREATE TABLE [dbo].[AGING DEFINITION](
	[AGINGCODE] [nvarchar](100) NULL,
	[AGINGDESCRIPTION] [nvarchar](500) NULL,
	[AGINGID] [int] IDENTITY(1,1) NOT NULL
) ON [PRIMARY]

/****** Object:  Table [dbo].[ARHISTORY]    Script Date: 5/31/2019 2:31:05 PM ******/
CREATE TABLE [dbo].[ARHISTORY](
	[SJPERIOD] [nvarchar](4) NULL,
	[CUSTOMERCODE] [nvarchar](100) NULL,
	[CUSTOMERDEFAULTBRANCHCODE] [nvarchar](100) NULL,
	[AREOMVALUE] [decimal](14, 4) NOT NULL,
	[EXTENDEDSALE] [decimal](14, 4) NULL,
	[CUSTOMERID] [int] NULL,
	[CUSTOMERDEFAULTBRANCHID] [int] NULL,
	[SJDATE]  AS (case when left([SJPERIOD],(2))='00' OR [SJPERIOD] IS NULL then NULL else CONVERT([datetime],(right([SJPERIOD],(2))+left([SJPERIOD],(2)))+'01',(112)) end) PERSISTED,
	[ARHISTORYID] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_ARHISTORY] PRIMARY KEY NONCLUSTERED 
(
	[ARHISTORYID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

/****** Object:  Table [dbo].[BRANCH]    Script Date: 5/31/2019 2:31:23 PM ******/
CREATE TABLE [dbo].[BRANCH](
	[BRANCHCODE] [nvarchar](100) NOT NULL,
	[BRANCHDESC] [nvarchar](500) NULL,
	[DIVISIONCODE] [nvarchar](100) NULL,
	[BRANCHID] [int] IDENTITY(1,1) NOT NULL,
	[DIVISIONID] [int] NULL,
	[BRANCHCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_BRANCH] PRIMARY KEY CLUSTERED 
(
	[BRANCHID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

/****** Object:  Table [dbo].[BUYLINE]    Script Date: 5/31/2019 2:31:47 PM ******/
CREATE TABLE [dbo].[BUYLINE](
	[BUYLINECODE] [nvarchar](100) NULL,
	[BUYLINEDESC] [nvarchar](500) NULL,
	[BUYLINEID] [int] IDENTITY(1,1) NOT NULL,
	[BUYLINECODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_BUYLINE] PRIMARY KEY CLUSTERED 
(
	[BUYLINEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

/****** Object:  Table [dbo].[CUSTCATEGORY]    Script Date: 5/31/2019 2:31:58 PM ******/
CREATE TABLE [dbo].[CUSTCATEGORY](
	[CUSTOMERCATCODE] [nvarchar](100) NULL,
	[CUSTOMERCATDESC] [nvarchar](500) NULL,
	[CUSTOMERCATID] [int] IDENTITY(1,1) NOT NULL,
	[CUSTOMERCATCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_CUSTCATEGORY] PRIMARY KEY CLUSTERED 
(
	[CUSTOMERCATID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

/****** Object:  Table [dbo].[CUSTOMER]    Script Date: 5/31/2019 2:32:08 PM ******/
CREATE TABLE [dbo].[CUSTOMER](
	[CUSTOMERCODE] [nvarchar](100) NOT NULL,
	[CUSTOMERDESC] [nvarchar](500) NULL,
	[ADD1] [nvarchar](500) NULL,
	[ADD2] [nvarchar](500) NULL,
	[CITY] [nvarchar](500) NULL,
	[STATE] [nvarchar](500) NULL,
	[ZIP] [nvarchar](100) NULL,
	[PHONE] [nvarchar](20) NULL,
	[FAX] [nvarchar](20) NULL,
	[EMAIL] [nvarchar](100) NULL,
	[CONTACT] [nvarchar](100) NULL,
	[SALESMANCODE] [nvarchar](100) NULL,
	[TERRITORYCODE] [nvarchar](100) NULL,
	[TYPE] [nvarchar](500) NULL,
	[CATEGORYCODE] [nvarchar](100) NULL,
	[AGING1] [decimal](14, 4) NULL,
	[AGING2] [decimal](14, 4) NULL,
	[AGING3] [decimal](14, 4) NULL,
	[AGING4] [decimal](14, 4) NULL,
	[AGING5] [decimal](14, 4) NULL,
	[AGING6] [decimal](14, 4) NULL,
	[AGING7] [decimal](14, 4) NULL,
	[CUSTOMERID] [int] IDENTITY(1,1) NOT NULL,
	[SALESMANID] [int] NULL,
	[TERRITORYID] [int] NULL,
	[CATEGORYID] [int] NULL,
	[CUSTOMERCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_CUSTOMER_1] PRIMARY KEY CLUSTERED 
(
	[CUSTOMERID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

/****** Object:  Table [dbo].[DIVISION]    Script Date: 5/31/2019 2:32:34 PM ******/
CREATE TABLE [dbo].[DIVISION](
	[DIVISIONCODE] [nvarchar](100) NOT NULL,
	[DIVISIONDESC] [nvarchar](500) NULL,
	[DIVISIONID] [int] IDENTITY(1,1) NOT NULL,
	[DIVISIONCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_DIVISION] PRIMARY KEY CLUSTERED 
(
	[DIVISIONID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

/****** Object:  Table [dbo].[INVENTORY]    Script Date: 5/31/2019 2:32:44 PM ******/
CREATE TABLE [dbo].[INVENTORY](
	[PRODUCTCODE] [nvarchar](100) NOT NULL,
	[WAREHOUSECODE] [nvarchar](100) NOT NULL,
	[WAREHOUSERANK] [nvarchar](100) NULL,
	[ONHAND] [decimal](14, 4) NOT NULL,
	[ONCOMMIT] [decimal](14, 4) NOT NULL,
	[AVAILABLE] [decimal](14, 4) NOT NULL,
	[ONPO] [decimal](14, 4) NOT NULL,
	[ONTRANSFER] [decimal](14, 4) NOT NULL,
	[STOCKVALUE] [decimal](14, 4) NOT NULL,
	[REORDERPOINT] [decimal](14, 4) NULL,
	[TWELVEMHITS] [decimal](14, 4) NOT NULL,
	[TWELVEMCOST] [decimal](14, 4) NOT NULL,
	[TWELVEMSALES] [decimal](14, 4) NOT NULL,
	[TWELVEMUNITS] [decimal](14, 4) NOT NULL,
	[TWELVEMDEMAND] [decimal](14, 4) NOT NULL,
	[TWELVEMAVERAGEINVAL] [decimal](14, 4) NOT NULL,
	[ONTRANSFERIN] [decimal](14, 4) NULL,
	[PRODUCTID] [int] NULL,
	[WAREHOUSEID] [int] NULL,
	[TWELVEMPROFIT]  AS ([TWELVEMSALES]-[TWELVEMCOST])
) ON [PRIMARY]

/****** Object:  Table [dbo].[INVENTORYHISTORY]    Script Date: 5/31/2019 2:33:01 PM ******/
CREATE TABLE [dbo].[INVENTORYHISTORY](
	[PRODUCTCODE] [nvarchar](100) NOT NULL,
	[WAREHOUSECODE] [nvarchar](100) NULL,
	[ONHAND0] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE0] [decimal](14, 4) NOT NULL,
	[ONHAND1] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE1] [decimal](14, 4) NOT NULL,
	[ONHAND2] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE2] [decimal](14, 4) NOT NULL,
	[ONHAND3] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE3] [decimal](14, 4) NOT NULL,
	[ONHAND4] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE4] [decimal](14, 4) NOT NULL,
	[ONHAND5] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE5] [decimal](14, 4) NOT NULL,
	[ONHAND6] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE6] [decimal](14, 4) NOT NULL,
	[ONHAND7] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE7] [decimal](14, 4) NOT NULL,
	[ONHAND8] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE8] [decimal](14, 4) NOT NULL,
	[ONHAND9] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE9] [decimal](14, 4) NOT NULL,
	[ONHAND10] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE10] [decimal](14, 4) NOT NULL,
	[ONHAND11] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE11] [decimal](14, 4) NOT NULL,
	[ONHAND12] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE12] [decimal](14, 4) NOT NULL,
	[ONHAND13] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE13] [decimal](14, 4) NOT NULL,
	[ONHAND14] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE14] [decimal](14, 4) NOT NULL,
	[ONHAND15] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE15] [decimal](14, 4) NOT NULL,
	[ONHAND16] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE16] [decimal](14, 4) NOT NULL,
	[ONHAND17] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE17] [decimal](14, 4) NOT NULL,
	[ONHAND18] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE18] [decimal](14, 4) NOT NULL,
	[ONHAND19] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE19] [decimal](14, 4) NOT NULL,
	[ONHAND20] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE20] [decimal](14, 4) NOT NULL,
	[ONHAND21] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE21] [decimal](14, 4) NOT NULL,
	[ONHAND22] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE22] [decimal](14, 4) NOT NULL,
	[ONHAND23] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE23] [decimal](14, 4) NOT NULL,
	[ONHAND24] [decimal](14, 4) NOT NULL,
	[INVENTORYVALUE24] [decimal](14, 4) NOT NULL,
	[PRODUCTID] [int] NULL,
	[WAREHOUSEID] [int] NULL
) ON [PRIMARY]

/****** Object:  Table [dbo].[INVOICEDETAIL]    Script Date: 5/31/2019 2:33:25 PM ******/
CREATE TABLE [dbo].[INVOICEDETAIL](
	[INVOICECODE] [nvarchar](100) NOT NULL,
	[LINENUM] [decimal](14, 4) NULL,
	[PRODUCTCODE] [nvarchar](100) NOT NULL,
	[SPDESCRIPTION] [nvarchar](691) NULL,
	[WAREHOUSECODE] [nvarchar](100) NULL,
	[SELLINGUOM] [nvarchar](10) NULL,
	[PRICINGUOM] [nvarchar](10) NULL,
	[COSTMETHOD] [nvarchar](100) NULL,
	[PRICEMETHOD] [nvarchar](100) NULL,
	[FILLSTATUS] [nvarchar](2) NULL,
	[QUANTITYSHIPPED] [decimal](14, 4) NOT NULL,
	[EXTENDEDCOST] [decimal](14, 4) NOT NULL,
	[EXTENDEDGLCOST] [decimal](14, 4) NOT NULL,
	[EXTENDEDSLMNCOST] [decimal](14, 4) NOT NULL,
	[EXTENDEDSALE] [decimal](14, 4) NOT NULL,
	[COMMISSION] [decimal](14, 4) NULL,
	[ORIGINALQUANTITY] [decimal](14, 4) NULL,
	[NETPRICE] [decimal](14, 4) NULL,
	[INVOICEDETAILID] [int] IDENTITY(100,1) NOT NULL,
	[INVOICEID] [int] NULL,
	[PRODUCTID] [int] NULL,
	[WAREHOUSEID] [int] NULL,
	[VENDORID] [int] NULL,
	[VENDORCODE] [nvarchar](100) NULL,
	[EXTENDEDPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDCOST]) PERSISTED,
	[EXTENDEDSLMNPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDSLMNCOST]) PERSISTED,
	[EXTENDEDGLPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDGLCOST]) PERSISTED,
 CONSTRAINT [PK_INVOICEDETAIL] PRIMARY KEY CLUSTERED 
(
	[INVOICEDETAILID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

/****** Object:  Table [dbo].[INVOICEHEADER]    Script Date: 5/31/2019 2:33:38 PM ******/
CREATE TABLE [dbo].[INVOICEHEADER](
	[INVOICECODE] [nvarchar](100) NOT NULL,
	[CUSTOMERCODE] [nvarchar](100) NULL,
	[SALESMANCODE] [nvarchar](100) NULL,
	[SHIPTOCODE] [nvarchar](100) NULL,
	[SHIPVIACODE] [nvarchar](100) NULL,
	[BRANCHCODE] [nvarchar](100) NULL,
	[ORDERWRITERCODE] [nvarchar](100) NULL,
	[INVOICEDATE] [datetime] NULL,
	[ORDERDATE] [datetime] NULL,
	[FISCALPERIOD] [nvarchar](4) NULL,
	[SJPERIOD] [nvarchar](4) NULL,
	[VOIDED] [nvarchar](50) NULL,
	[JOBID] [nvarchar](100) NULL,
	[CUSTOMERPO] [nvarchar](231) NULL,
	[ORDERTYPE] [nvarchar](100) NULL,
	[FREIGHT] [decimal](14, 4) NULL,
	[MISC] [decimal](14, 4) NULL,
	[TAX] [decimal](14, 4) NULL,
	[INVOICETOTAL] [decimal](14, 4) NULL,
	[INVOICEBALANCE] [decimal](14, 4) NULL,
	[SHIPTOCITY] [nvarchar](100) NULL,
	[SHIPTOSTATE] [nvarchar](100) NULL,
	[SHIPTOZIP] [nvarchar](100) NULL,
	[TERRITORYCODE] [nvarchar](100) NULL,
	[CASHSALE] [nvarchar](1) NULL,
	[INVOICEID] [int] IDENTITY(1,1) NOT NULL,
	[CUSTOMERID] [int] NULL,
	[SALESMANID] [int] NULL,
	[SHIPTOID] [int] NULL,
	[SHIPVIAID] [int] NULL,
	[BRANCHID] [int] NULL,
	[ORDERWRITERID] [int] NULL,
	[TERRITORYID] [int] NULL,
	[FISCALDATE]  AS (case when left([FISCALPERIOD],(2))='00' OR [FISCALPERIOD] IS NULL then NULL else CONVERT([datetime],(right([FISCALPERIOD],(2))+left([FISCALPERIOD],(2)))+'01',(112)) end) PERSISTED,
	[SJDATE]  AS (case when left([SJPERIOD],(2))='00' then dateadd(month,datediff(month,(0),[INVOICEDATE]),(0)) else CONVERT([datetime],(right([SJPERIOD],(2))+left([SJPERIOD],(2)))+'01',(112)) end) PERSISTED,
	[ISCASHSALE]  AS (case when [CASHSALE]='Y' then (1) else (0) end) PERSISTED NOT NULL,
 CONSTRAINT [PK_INVOICEHEADER] PRIMARY KEY CLUSTERED 
(
	[INVOICEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

/****** Object:  Table [dbo].[INVOICESUMMARY]    Script Date: 5/31/2019 2:33:47 PM ******/
CREATE TABLE [dbo].[INVOICESUMMARY](
	[INVOICEDATE] [datetime] NULL,
	[ORDERDATE] [datetime] NULL,
	[FISCALPERIOD] [nvarchar](4) NULL,
	[SJPERIOD] [nvarchar](4) NULL,
	[VOIDED] [nvarchar](1) NULL,
	[JOBID] [nvarchar](10) NULL,
	[CUSTOMERPO] [nvarchar](30) NULL,
	[ORDERTYPE] [nvarchar](8) NULL,
	[CUSTOMERID] [int] NULL,
	[SALESMANID] [int] NULL,
	[SHIPTOID] [int] NULL,
	[SHIPVIAID] [int] NULL,
	[BRANCHID] [int] NULL,
	[PRODUCTID] [int] NULL,
	[WAREHOUSEID] [int] NULL,
	[FILLED] [int] NULL,
	[PTFILLED] [int] NULL,
	[QUANTITYSHIPPED] [decimal](14, 4) NULL,
	[EXTENDEDCOST] [decimal](14, 4) NULL,
	[EXTENDEDGLCOST] [decimal](14, 4) NULL,
	[EXTENDEDSLMNCOST] [decimal](14, 4) NULL,
	[EXTENDEDSALE] [decimal](14, 4) NULL,
	[COMMISSION] [decimal](14, 4) NULL,
	[SHIPTOCITY] [nvarchar](100) NULL,
	[SHIPTOSTATE] [nvarchar](100) NULL,
	[SHIPTOZIP] [nvarchar](100) NULL,
	[TERRITORYCODE] [nvarchar](100) NULL,
	[INVOICESUMMARYID] [int] IDENTITY(1,1) NOT NULL,
	[FISCALDATE]  AS (case when left([FISCALPERIOD],(2))='00' OR [FISCALPERIOD] IS NULL then NULL else CONVERT([datetime],(right([FISCALPERIOD],(2))+left([FISCALPERIOD],(2)))+'01',(112)) end) PERSISTED,
	[EXTENDEDPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDCOST]) PERSISTED,
	[EXTENDEDSLMNPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDSLMNCOST]) PERSISTED,
	[EXTENDEDGLPROFIT]  AS ([EXTENDEDSALE]-[EXTENDEDGLCOST]) PERSISTED,
	[ORDERWRITERID] [int] NULL,
	[TERRITORYID] [int] NULL,
	[INVOICEID] [int] NULL,
	[INVOICECODE] [nvarchar](100) NULL,
	[SJDATE]  AS (case when left([SJPERIOD],(2))='00' OR [SJPERIOD] IS NULL then dateadd(month,datediff(month,(0),[INVOICEDATE]),(0)) else CONVERT([datetime],(right([SJPERIOD],(2))+left([SJPERIOD],(2)))+'01',(112)) end) PERSISTED,
 CONSTRAINT [PK_INVOICESUMMARY] PRIMARY KEY CLUSTERED 
(
	[INVOICESUMMARYID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[INVOICEVARIANCE]    Script Date: 5/31/2019 2:34:28 PM ******/


SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[INVOICEVARIANCE](
	[CUSTOMERID] [int] NULL,
	[SHIPTOID] [int] NULL,
	[SHIPVIAID] [int] NULL,
	[BRANCHID] [int] NULL,
	[ORDERWRITERID] [int] NULL,
	[PRODUCTID] [int] NULL,
	[WAREHOUSEID] [int] NULL,
	[YTDSALES] [decimal](14, 4) NULL,
	[LYTDSALES] [decimal](14, 4) NULL,
	[FYTDSALES] [decimal](14, 4) NULL,
	[LFYTDSALES] [decimal](14, 4) NULL,
	[YTDCOST] [decimal](14, 4) NULL,
	[LYTDCOST] [decimal](14, 4) NULL,
	[FYTDCOST] [decimal](14, 4) NULL,
	[LFYTDCOST] [decimal](14, 4) NULL,
	[YTDUNITS] [decimal](14, 4) NULL,
	[LYTDUNITS] [decimal](14, 4) NULL,
	[FYTDUNITS] [decimal](14, 4) NULL,
	[LFYTDUNITS] [decimal](14, 4) NULL,
	[YTDPROFIT]  AS ([YTDSALES]-[YTDCOST]) PERSISTED,
	[LYTDPROFIT]  AS ([LYTDSALES]-[LYTDCOST]) PERSISTED,
	[FYTDPROFIT]  AS ([FYTDSALES]-[FYTDCOST]) PERSISTED,
	[LFYTDPROFIT]  AS ([LFYTDSALES]-[LFYTDCOST]) PERSISTED,
	[SALESVARIANCE]  AS ([YTDSALES]-[LYTDSALES]) PERSISTED,
	[COSTVARIANCE]  AS ([YTDCOST]-[LYTDCOST]) PERSISTED,
	[PROFITVARIANCE]  AS (([YTDSALES]-[YTDCOST])-([LYTDSALES]-[LYTDCOST])) PERSISTED,
	[UNITSVARIANCE]  AS ([YTDUNITS]-[LYTDUNITS]) PERSISTED,
	[FSALESVARIANCE]  AS ([FYTDSALES]-[LFYTDSALES]) PERSISTED,
	[FCOSTVARIANCE]  AS ([FYTDCOST]-[LFYTDCOST]) PERSISTED,
	[FPROFITVARIANCE]  AS (([FYTDSALES]-[FYTDCOST])-([LFYTDSALES]-[LFYTDCOST])) PERSISTED,
	[FUNITSVARIANCE]  AS ([FYTDUNITS]-[LFYTDUNITS]) PERSISTED,
	[SALESMANCODE] [nvarchar](4) NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[LAYOUT DEFINITIONS]    Script Date: 5/31/2019 2:34:38 PM ******/


CREATE TABLE [dbo].[LAYOUT DEFINITIONS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[LayoutName] [nvarchar](max) NOT NULL,
	[DataSet] [nvarchar](20) NOT NULL,
	[DisplayMode] [nvarchar](20) NOT NULL,
	[Layout] [image] NOT NULL,
 CONSTRAINT [PK_LAYOUT DEFINITIONS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

ALTER TABLE [dbo].[LAYOUT DEFINITIONS]  WITH CHECK ADD  CONSTRAINT [FK_LAYOUT DEFINITIONS_LAYOUT DEFINITIONS] FOREIGN KEY([ID])
REFERENCES [dbo].[LAYOUT DEFINITIONS] ([ID])
GO

ALTER TABLE [dbo].[LAYOUT DEFINITIONS] CHECK CONSTRAINT [FK_LAYOUT DEFINITIONS_LAYOUT DEFINITIONS]
GO


USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[PRICEGROUP]    Script Date: 5/31/2019 3:36:51 PM ******/


CREATE TABLE [dbo].[PRICEGROUP](
	[PRICEGROUPCODE] [nvarchar](100) NOT NULL,
	[PRICEGROUPDESC] [nvarchar](500) NULL,
	[PRICEGROUPID] [int] IDENTITY(1,1) NOT NULL,
	[PRICEGROUPCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_PRICEGROUP_1] PRIMARY KEY CLUSTERED 
(
	[PRICEGROUPID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[PRODLINE]    Script Date: 5/31/2019 3:37:01 PM ******/


CREATE TABLE [dbo].[PRODLINE](
	[PRODUCTLINECODE] [nvarchar](100) NOT NULL,
	[PRODUCTLINEDESC] [nvarchar](500) NULL,
	[MAJORGROUP] [nvarchar](100) NULL,
	[PRODUCTLINEBUYERS] [nvarchar](500) NULL,
	[PRODUCTLINEID] [int] IDENTITY(1,1) NOT NULL,
	[PRODUCTLINECODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_PRODLINE] PRIMARY KEY CLUSTERED 
(
	[PRODUCTLINEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[PRODUCT]    Script Date: 5/31/2019 3:37:16 PM ******/


CREATE TABLE [dbo].[PRODUCT](
	[PRODUCTCODE] [nvarchar](100) NOT NULL,
	[PRODUCTLINECODE] [nvarchar](100) NULL,
	[PRICEGROUPCODE] [nvarchar](100) NULL,
	[BUYLINECODE] [nvarchar](100) NULL,
	[VENDORCODE] [nvarchar](100) NULL,
	[WEBCATCODE] [nvarchar](100) NULL,
	[STATUS] [nvarchar](1) NULL,
	[OVERALLRANK] [nvarchar](1) NULL,
	[PRODUCTDESC] [nvarchar](500) NULL,
	[C1COST] [decimal](14, 4) NULL,
	[C2COST] [decimal](14, 4) NULL,
	[C3COST] [decimal](14, 4) NULL,
	[C4COST] [decimal](14, 4) NULL,
	[C5COST] [decimal](14, 4) NULL,
	[C6COST] [decimal](14, 4) NULL,
	[C7COST] [decimal](14, 4) NULL,
	[L1PRICE] [decimal](14, 4) NULL,
	[L2PRICE] [decimal](14, 4) NULL,
	[L3PRICE] [decimal](14, 4) NULL,
	[L4PRICE] [decimal](14, 4) NULL,
	[PRODUCTID] [int] IDENTITY(1,1) NOT NULL,
	[PRODUCTLINEID] [int] NOT NULL CONSTRAINT [DF_PRODUCT_PRODUCTLINEID]  DEFAULT ((0)),
	[PRICEGROUPID] [int] NOT NULL CONSTRAINT [DF_PRODUCT_PRICEGROUPID]  DEFAULT ((0)),
	[BUYLINEID] [int] NOT NULL CONSTRAINT [DF_PRODUCT_BUYLINEID]  DEFAULT ((0)),
	[VENDORID] [int] NOT NULL CONSTRAINT [DF_PRODUCT_VENDORID]  DEFAULT ((0)),
	[WEBCATID] [int] NOT NULL CONSTRAINT [DF_PRODUCT_WEBCATID]  DEFAULT ((0)),
	[PRODUCTCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_PRODUCT] PRIMARY KEY CLUSTERED 
(
	[PRODUCTID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[PURCHASEORDERDETAIL]    Script Date: 5/31/2019 3:38:17 PM ******/

CREATE TABLE [dbo].[PURCHASEORDERDETAIL](
	[POCODE] [nvarchar](100) NOT NULL,
	[RECEIVINGCODE] [nvarchar](100) NOT NULL,
	[PRODUCTCODE] [nvarchar](100) NOT NULL,
	[UNITS] [decimal](14, 4) NOT NULL,
	[COST] [decimal](14, 4) NOT NULL,
	[PORECEIVINGID] [int] NULL,
	[PRODUCTID] [int] NULL
) ON [PRIMARY]

GO
USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[PURCHASEORDERHEADER]    Script Date: 5/31/2019 3:38:44 PM ******/


SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[PURCHASEORDERHEADER](
	[POCODE] [nvarchar](100) NOT NULL,
	[RECEIVINGCODE] [nvarchar](100) NOT NULL,
	[VENDORCODE] [nvarchar](100) NULL,
	[RECEIVINGDATE] [datetime] NULL,
	[SJPERIOD] [nvarchar](4) NULL,
	[PODATE] [datetime] NULL,
	[BRANCHCODE] [nvarchar](100) NULL,
	[PORECEIVINGID] [int] IDENTITY(1,1) NOT NULL,
	[VENDORID] [int] NULL,
	[BRANCHID] [int] NULL,
	[SJDATE]  AS (case when left([SJPERIOD],(2))='00' OR [SJPERIOD] IS NULL then dateadd(month,datediff(month,(0),[RECEIVINGDATE]),(0)) else CONVERT([datetime],(right([SJPERIOD],(2))+left([SJPERIOD],(2)))+'01',(112)) end) PERSISTED,
 CONSTRAINT [PK_PURCHASEORDERHEADER] PRIMARY KEY CLUSTERED 
(
	[PORECEIVINGID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[SALESMAN]    Script Date: 5/31/2019 3:38:53 PM ******/

CREATE TABLE [dbo].[SALESMAN](
	[SALESMANCODE] [nvarchar](100) NOT NULL,
	[SALESMANDESC] [nvarchar](200) NULL,
	[SALESMANID] [int] IDENTITY(1,1) NOT NULL,
	[SALESMANCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_SALESMAN] PRIMARY KEY CLUSTERED 
(
	[SALESMANID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO


USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[SHIPTO]    Script Date: 5/31/2019 3:39:12 PM ******/


CREATE TABLE [dbo].[SHIPTO](
	[SHIPTOCODE] [nvarchar](100) NOT NULL,
	[CUSTOMERCODE] [nvarchar](100) NULL,
	[SHIPTODESC] [nvarchar](500) NULL,
	[ADD1] [nvarchar](500) NULL,
	[ADD2] [nvarchar](500) NULL,
	[CITY] [nvarchar](500) NULL,
	[STATE] [nvarchar](500) NULL,
	[ZIP] [nvarchar](20) NULL,
	[SHIPTOID] [int] IDENTITY(1,1) NOT NULL,
	[CUSTOMERID] [int] NULL,
	[SHIPTOSUBCODE]  AS (replace([SHIPTOCODE],[CUSTOMERCODE]+'!','')),
	[SHIPTOCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_SHIPTO] PRIMARY KEY CLUSTERED 
(
	[SHIPTOID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[SHIPVIA]    Script Date: 5/31/2019 3:39:21 PM ******/


CREATE TABLE [dbo].[SHIPVIA](
	[SHIPVIACODE] [nvarchar](12) NULL,
	[SHIPVIADESC] [nvarchar](500) NULL,
	[SHIPVIATYPE] [nvarchar](20) NULL,
	[SHIPVIAID] [int] IDENTITY(1,1) NOT NULL,
	[SHIPVIACODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_SHIPVIA] PRIMARY KEY CLUSTERED 
(
	[SHIPVIAID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[TERRITORY]    Script Date: 5/31/2019 3:39:34 PM ******/

CREATE TABLE [dbo].[TERRITORY](
	[TERRITORYCODE] [nvarchar](10) NULL,
	[TERRITORYDESC] [nvarchar](500) NULL,
	[TERRITORYID] [int] IDENTITY(1,1) NOT NULL,
	[TERRITORYCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_TERRITORY] PRIMARY KEY CLUSTERED 
(
	[TERRITORYID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[USER]    Script Date: 5/31/2019 3:39:42 PM ******/

CREATE TABLE [dbo].[USER](
	[USERCODE] [nvarchar](10) NOT NULL,
	[USERDESC] [nvarchar](500) NULL,
	[USERID] [int] IDENTITY(1,1) NOT NULL,
	[USERCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_USER] PRIMARY KEY CLUSTERED 
(
	[USERID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[VM]    Script Date: 5/31/2019 3:39:51 PM ******/

CREATE TABLE [dbo].[VM](
	[VENDORCODE] [nvarchar](100) NOT NULL,
	[VENDORDESC] [nvarchar](500) NULL,
	[ADD1] [nvarchar](500) NULL,
	[ADD2] [nvarchar](500) NULL,
	[CITY] [nvarchar](500) NULL,
	[STATE] [nvarchar](500) NULL,
	[ZIP] [nvarchar](500) NULL,
	[PHONE] [nvarchar](500) NULL,
	[FAX] [nvarchar](500) NULL,
	[EMAIL] [nvarchar](500) NULL,
	[CONTACT] [nvarchar](500) NULL,
	[INVENTORYTURNS] [decimal](14, 4) NULL,
	[LEADTIMEDAYS] [decimal](14, 4) NULL,
	[VENDORCATEGORYCODE] [nvarchar](100) NULL,
	[VENDORBUYERS] [nvarchar](max) NULL,
	[VENDORID] [int] IDENTITY(1,1) NOT NULL,
	[VENDORCATEGORYID] [int] NULL,
	[VENDORCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_VM_1] PRIMARY KEY CLUSTERED 
(
	[VENDORID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[VMCATEGORY]    Script Date: 5/31/2019 3:40:01 PM ******/
CREATE TABLE [dbo].[VMCATEGORY](
	[VENDORCATCODE] [nvarchar](100) NOT NULL,
	[VENDORCATDESC] [nvarchar](500) NULL,
	[VENDORCATID] [int] IDENTITY(1,1) NOT NULL,
	[VENDORCATCODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_VMCATEGORY] PRIMARY KEY CLUSTERED 
(
	[VENDORCATID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[WAREHOUSE]    Script Date: 5/31/2019 3:40:09 PM ******/
CREATE TABLE [dbo].[WAREHOUSE](
	[WAREHOUSECODE] [nvarchar](100) NOT NULL,
	[WAREHOUSEDESC] [nvarchar](500) NULL,
	[WAREHOUSETYPE] [nvarchar](50) NULL,
	[WAREHOUSEID] [int] IDENTITY(1,1) NOT NULL,
	[WAREHOUSECODEDESC] [nvarchar](max) NULL,
 CONSTRAINT [PK_WAREHOUSE_1] PRIMARY KEY CLUSTERED 
(
	[WAREHOUSEID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
USE [DDiDataWarehouse]
GO

/****** Object:  Table [dbo].[WEBCAT]    Script Date: 5/31/2019 3:40:17 PM ******/


CREATE TABLE [dbo].[WEBCAT](
	[WEBCATCODE] [nvarchar](100) NOT NULL,
	[WEBCATDESC] [nvarchar](500) NULL,
	[WEBCATPARENTCODE] [nvarchar](100) NULL,
	[WEBCATID] [int] IDENTITY(1,1) NOT NULL,
	[WEBCATPARENTID] [int] NULL,
 CONSTRAINT [PK_WEBCAT] PRIMARY KEY CLUSTERED 
(
	[WEBCATID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO





